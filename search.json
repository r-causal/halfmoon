[{"path":"https://r-causal.github.io/halfmoon/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2023 halfmoon authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://r-causal.github.io/halfmoon/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Malcolm Barrett. Author, maintainer, copyright holder.","code":""},{"path":"https://r-causal.github.io/halfmoon/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Barrett M (2025). halfmoon: Techniques Build Better Balance. R package version 0.1.0.9000, https://github.com/r-causal/halfmoon.","code":"@Manual{,   title = {halfmoon: Techniques to Build Better Balance},   author = {Malcolm Barrett},   year = {2025},   note = {R package version 0.1.0.9000},   url = {https://github.com/r-causal/halfmoon}, }"},{"path":"https://r-causal.github.io/halfmoon/index.html","id":"halfmoon-","dir":"","previous_headings":"","what":"Techniques to Build Better Balance","title":"Techniques to Build Better Balance","text":"Within light darkness, try understand darkness. Within darkness light, look light. Light darkness pair like foot foot behind walking. – Zen teaching poem Sandokai. goal halfmoon cultivate balance propensity score models.","code":""},{"path":"https://r-causal.github.io/halfmoon/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Techniques to Build Better Balance","text":"can install recent version halfmoon CRAN : can also install development version halfmoon GitHub :","code":"install.packages(\"halfmoon\") # install.packages(\"devtools\") devtools::install_github(\"malcolmbarrett/halfmoon\")"},{"path":"https://r-causal.github.io/halfmoon/index.html","id":"example-weighting","dir":"","previous_headings":"","what":"Example: Weighting","title":"Techniques to Build Better Balance","text":"halfmoon includes several techniques assessing balance created propensity score weights.","code":"library(halfmoon) library(ggplot2)  # weighted mirrored histograms ggplot(nhefs_weights, aes(.fitted)) +   geom_mirror_histogram(     aes(group = qsmk),     bins = 50   ) +   geom_mirror_histogram(     aes(fill = qsmk, weight = w_ate),     bins = 50,     alpha = 0.5   ) + scale_y_continuous(labels = abs) # weighted ecdf ggplot(   nhefs_weights,   aes(x = smokeyrs, color = qsmk) ) +   geom_ecdf(aes(weights = w_ato)) +   xlab(\"Smoking Years\") +   ylab(\"Proportion <= x\") # weighted SMDs plot_df <- tidy_smd(   nhefs_weights,   race:active,   .group = qsmk,   .wts = starts_with(\"w_\") )  ggplot(   plot_df,   aes(     x = abs(smd),     y = variable,     group = method,     color = method   ) ) +   geom_love()"},{"path":"https://r-causal.github.io/halfmoon/index.html","id":"example-matching","dir":"","previous_headings":"","what":"Example: Matching","title":"Techniques to Build Better Balance","text":"halfmoon also support working matched datasets. Consider two objects MatchIt documentation: One option just look matched dataset halfmoon:  downside can’t compare multiple matching strategies observed dataset; label plot also wrong. halfmoon comes helper function, bind_matches(), creates dataset appropriate task: matches includes binary variable matchit object indicates row included match . Since downweighting 0 equivalent filtering datasets matches, can easily compare multiple matched datasets .wts:  can also extend idea matching indicators weights weighted mirrored histograms, giving us good idea range propensity scores removed dataset.","code":"library(MatchIt) # Default: 1:1 NN PS matching w/o replacement m.out1 <- matchit(treat ~ age + educ + race + nodegree +                    married + re74 + re75, data = lalonde)  # 1:1 NN Mahalanobis distance matching w/ replacement and # exact matching on married and race m.out2 <- matchit(treat ~ age + educ + race + nodegree +                    married + re74 + re75, data = lalonde,                    distance = \"mahalanobis\", replace = TRUE,                   exact = ~ married + race) matched_data <- get_matches(m.out1)  match_smd <- tidy_smd(   matched_data,   c(age, educ, race, nodegree, married, re74, re75),    .group = treat )  love_plot(match_smd) matches <- bind_matches(lalonde, m.out1, m.out2) head(matches) #>      treat age educ   race married nodegree re74 re75       re78 m.out1 m.out2 #> NSW1     1  37   11  black       1        1    0    0  9930.0460      1      1 #> NSW2     1  22    9 hispan       0        1    0    0  3595.8940      1      1 #> NSW3     1  30   12  black       0        0    0    0 24909.4500      1      1 #> NSW4     1  27   11  black       0        1    0    0  7506.1460      1      1 #> NSW5     1  33    8  black       0        1    0    0   289.7899      1      1 #> NSW6     1  22    9  black       0        1    0    0  4056.4940      1      1 many_matched_smds <- tidy_smd(   matches,   c(age, educ, race, nodegree, married, re74, re75),    .group = treat,    .wts = c(m.out1, m.out2) )   love_plot(many_matched_smds) # use the distance as the propensity score matches$ps <- m.out1$distance  ggplot(matches, aes(ps)) +     geom_mirror_histogram(         aes(group = factor(treat)),         bins = 50     ) +     geom_mirror_histogram(         aes(fill = factor(treat), weight = m.out1),         bins = 50,         alpha = 0.5     ) + scale_y_continuous(labels = abs)"},{"path":"https://r-causal.github.io/halfmoon/reference/add_ess_header.html","id":null,"dir":"Reference","previous_headings":"","what":"Add ESS Table Header — add_ess_header","title":"Add ESS Table Header — add_ess_header","text":"function replaces counts default header gtsummary::tbl_svysummary() tables counts representing Effective Sample Size (ESS). See ess() details.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/add_ess_header.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add ESS Table Header — add_ess_header","text":"","code":"add_ess_header(   x,   header = \"**{level}**  \\nESS = {format(n, digits = 1, nsmall = 1)}\" )"},{"path":"https://r-causal.github.io/halfmoon/reference/add_ess_header.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add ESS Table Header — add_ess_header","text":"x (tbl_svysummary) Object class 'tbl_svysummary' typically created gtsummary::tbl_svysummary(). header (string) String specifying updated header. Review gtsummary::modify_header() details use.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/add_ess_header.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add ESS Table Header — add_ess_header","text":"'gtsummary' table","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/add_ess_header.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add ESS Table Header — add_ess_header","text":"","code":"svy <- survey::svydesign(~1, data = nhefs_weights, weights = ~ w_ate)  gtsummary::tbl_svysummary(svy, include = c(age, sex, smokeyrs)) |>   add_ess_header()     Characteristic       Overall ESS = 1013.31     AGE IN 1971 43 (33, 53)0: MALE 1: FEMALE     0 1,527 (49%)    1 1,599 (51%)YEARS OF SMOKING 24 (14, 33)Abbreviation: ESS = Effective Sample Size     1 Median (Q1, Q3); n (%)     hdr <- paste0(   \"**{level}**  \\n\",   \"N = {n_unweighted}; ESS = {format(n, digits = 1, nsmall = 1)}\" ) gtsummary::tbl_svysummary(svy, by = qsmk, include = c(age, sex, smokeyrs)) |>   add_ess_header(header = hdr)     Characteristic       0 N = 1163; ESS = 1128.61       1 N = 403; ESS = 326.01     AGE IN 1971 43 (33, 52) 43 (33, 53)0: MALE 1: FEMALE      0 764 (49%) 764 (49%)    1 802 (51%) 797 (51%)YEARS OF SMOKING 24 (15, 33) 24 (14, 33)Abbreviation: ESS = Effective Sample Size     1 Median (Q1, Q3); n (%)"},{"path":"https://r-causal.github.io/halfmoon/reference/bal_corr.html","id":null,"dir":"Reference","previous_headings":"","what":"Balance Weighted or Unweighted Pearson Correlation — bal_corr","title":"Balance Weighted or Unweighted Pearson Correlation — bal_corr","text":"Calculates Pearson correlation coefficient two numeric vectors, optional case weights. Uses standard correlation formula unweighted data weighted covariance weighted data.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/bal_corr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Balance Weighted or Unweighted Pearson Correlation — bal_corr","text":"","code":"bal_corr(x, y, weights = NULL, na.rm = FALSE)"},{"path":"https://r-causal.github.io/halfmoon/reference/bal_corr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Balance Weighted or Unweighted Pearson Correlation — bal_corr","text":"x numeric vector containing first variable. y numeric vector containing second variable. Must length x. weights optional numeric vector case weights. provided, must length x y. weights must non-negative. na.rm logical value indicating whether remove missing values computation. FALSE (default), missing values result NA output.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/bal_corr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Balance Weighted or Unweighted Pearson Correlation — bal_corr","text":"numeric value representing correlation coefficient -1 1. Returns NA either variable zero variance.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/bal_corr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Balance Weighted or Unweighted Pearson Correlation — bal_corr","text":"","code":"bal_corr(nhefs_weights$age, nhefs_weights$wt71) #> [1] 0.02219162"},{"path":"https://r-causal.github.io/halfmoon/reference/bal_energy.html","id":null,"dir":"Reference","previous_headings":"","what":"Balance Energy Distance — bal_energy","title":"Balance Energy Distance — bal_energy","text":"Computes energy distance multivariate measure covariate balance groups. Energy distance captures similarity distributions across entire joint distribution covariates, making comprehensive univariate balance measures.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/bal_energy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Balance Energy Distance — bal_energy","text":"","code":"bal_energy(   covariates,   group,   weights = NULL,   estimand = NULL,   treatment_level = NULL,   use_improved = TRUE,   standardized = TRUE,   na.rm = FALSE )"},{"path":"https://r-causal.github.io/halfmoon/reference/bal_energy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Balance Energy Distance — bal_energy","text":"covariates data frame matrix containing covariates compare. group vector (factor numeric) indicating group membership. binary multi-category treatments, must 2+ unique levels. continuous treatments, numeric. weights optional numeric vector weights. provided, must length rows covariates. weights must non-negative. estimand Character string specifying estimand. Options : NULL (default): Pure -group energy distance comparing distributions \"ATE\": Energy distance weighted reflect balance estimating average treatment effects across entire population \"ATT\": Energy distance weighted reflect balance treated group, measuring well controls match treated distribution \"ATC\": Energy distance weighted reflect balance control group, measuring well treated units match control distribution continuous treatments, NULL supported. treatment_level treatment level ATT/ATC. NULL (default), automatically determined based estimand. use_improved Logical. Use improved energy distance ATE? Default TRUE. TRUE, adds pairwise treatment comparisons better group separation. standardized Logical. continuous treatments, return standardized distance correlation? Default TRUE. na.rm logical value indicating whether remove missing values computation. FALSE (default), missing values result error (energy distance computed missing data).","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/bal_energy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Balance Energy Distance — bal_energy","text":"numeric value representing energy distance groups. Lower values indicate better balance, 0 indicating perfect balance (identical distributions). continuous treatments, returns distance correlation coefficient (0 = independence, 1 = perfect dependence).","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/bal_energy.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Balance Energy Distance — bal_energy","text":"Energy distance based energy statistics framework (Székely & Rizzo, 2004) implemented following Huling & Mak (2024) Huling et al. (2024). calculation uses quadratic form: \\(w^T P w + q^T w + k\\), components depend estimand. binary variables covariates, variance calculated p(1-p) rather sample variance prevent -weighting. continuous treatments, function uses distance correlation instead traditional energy distance, measuring independence treatment covariates.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/bal_energy.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Balance Energy Distance — bal_energy","text":"Huling, J. D., & Mak, S. (2024). Energy Balancing Covariate Distributions. Journal Causal Inference, 12(1) . Huling, J. D., Greifer, N., & Chen, G. (2023). Independence weights causal inference continuous treatments. Journal American Statistical Association, 0(ja), 1–25. doi:10.1080/01621459.2023.2213485 Székely, G. J., & Rizzo, M. L. (2004). Testing equal distributions high dimension. InterStat, 5.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/bal_energy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Balance Energy Distance — bal_energy","text":"","code":"# Binary treatment bal_energy(   covariates = dplyr::select(nhefs_weights, age, wt71, smokeyrs),   group = nhefs_weights$qsmk ) #> [1] 0.05159867  # With weights bal_energy(   covariates = dplyr::select(nhefs_weights, age, wt71, smokeyrs),   group = nhefs_weights$qsmk,   weights = nhefs_weights$w_ate ) #> [1] 0.002998391  # ATT estimand bal_energy(   covariates = dplyr::select(nhefs_weights, age, wt71, smokeyrs),   group = nhefs_weights$qsmk,   weights = nhefs_weights$w_att,   estimand = \"ATT\" ) #> [1] 0.003318796"},{"path":"https://r-causal.github.io/halfmoon/reference/bal_ks.html","id":null,"dir":"Reference","previous_headings":"","what":"Balance Kolmogorov-Smirnov (KS) Statistic for Two Groups — bal_ks","title":"Balance Kolmogorov-Smirnov (KS) Statistic for Two Groups — bal_ks","text":"Computes two-sample KS statistic comparing empirical cumulative distribution functions (CDFs) two groups. binary variables, returns absolute difference proportions. continuous variables, computes maximum difference empirical CDFs.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/bal_ks.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Balance Kolmogorov-Smirnov (KS) Statistic for Two Groups — bal_ks","text":"","code":"bal_ks(covariate, group, weights = NULL, reference_group = NULL, na.rm = FALSE)"},{"path":"https://r-causal.github.io/halfmoon/reference/bal_ks.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Balance Kolmogorov-Smirnov (KS) Statistic for Two Groups — bal_ks","text":"covariate numeric vector containing covariate values compare. group vector (factor numeric) indicating group membership. Must exactly two unique levels. weights optional numeric vector case weights. provided, must length covariate. weights must non-negative. reference_group reference group level use comparison baseline. NULL (default), uses first level. na.rm logical value indicating whether remove missing values computation. FALSE (default), missing values result NA output.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/bal_ks.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Balance Kolmogorov-Smirnov (KS) Statistic for Two Groups — bal_ks","text":"numeric value representing KS statistic. Values range 0 1, 0 indicating identical distributions 1 indicating completely separate distributions.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/bal_ks.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Balance Kolmogorov-Smirnov (KS) Statistic for Two Groups — bal_ks","text":"","code":"bal_ks(nhefs_weights$age, nhefs_weights$qsmk) #> [1] 0.1295593  # With weights bal_ks(nhefs_weights$wt71, nhefs_weights$qsmk,            weights = nhefs_weights$w_ate) #> [1] 0.03583763"},{"path":"https://r-causal.github.io/halfmoon/reference/bal_smd.html","id":null,"dir":"Reference","previous_headings":"","what":"Balance Standardized Mean Difference (SMD) — bal_smd","title":"Balance Standardized Mean Difference (SMD) — bal_smd","text":"Calculates standardized mean difference two groups using smd package. common measure effect size comparing group differences accounting variability.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/bal_smd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Balance Standardized Mean Difference (SMD) — bal_smd","text":"","code":"bal_smd(   covariate,   group,   weights = NULL,   reference_group = NULL,   na.rm = FALSE )"},{"path":"https://r-causal.github.io/halfmoon/reference/bal_smd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Balance Standardized Mean Difference (SMD) — bal_smd","text":"covariate numeric vector containing covariate values compare. group vector (factor numeric) indicating group membership. Must exactly two unique levels. weights optional numeric vector case weights. provided, must length covariate. weights must non-negative. reference_group reference group level use comparison baseline. Can either group level index. NULL (default), uses first level. na.rm logical value indicating whether remove missing values computation. FALSE (default), missing values result NA output.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/bal_smd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Balance Standardized Mean Difference (SMD) — bal_smd","text":"numeric value representing standardized mean difference. Positive values indicate comparison group higher mean reference group.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/bal_smd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Balance Standardized Mean Difference (SMD) — bal_smd","text":"","code":"bal_smd(nhefs_weights$age, nhefs_weights$qsmk) #> [1] -0.2822208  # With weights bal_smd(nhefs_weights$wt71, nhefs_weights$qsmk,             weights = nhefs_weights$w_ate) #> [1] 0.009030294"},{"path":"https://r-causal.github.io/halfmoon/reference/bal_vr.html","id":null,"dir":"Reference","previous_headings":"","what":"Balance Variance Ratio for Two Groups — bal_vr","title":"Balance Variance Ratio for Two Groups — bal_vr","text":"Calculates ratio variances two groups: var(comparison) / var(reference). binary variables, uses p*(1-p) variance formula. continuous variables, uses Bessel's correction weighted sample variance.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/bal_vr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Balance Variance Ratio for Two Groups — bal_vr","text":"","code":"bal_vr(covariate, group, weights = NULL, reference_group = NULL, na.rm = FALSE)"},{"path":"https://r-causal.github.io/halfmoon/reference/bal_vr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Balance Variance Ratio for Two Groups — bal_vr","text":"covariate numeric vector containing covariate values compare. group vector (factor numeric) indicating group membership. Must exactly two unique levels. weights optional numeric vector case weights. provided, must length covariate. weights must non-negative. reference_group reference group level use denominator. NULL (default), uses first level. na.rm logical value indicating whether remove missing values computation. FALSE (default), missing values result NA output.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/bal_vr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Balance Variance Ratio for Two Groups — bal_vr","text":"numeric value representing variance ratio. Values greater 1 indicate comparison group higher variance reference group.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/bal_vr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Balance Variance Ratio for Two Groups — bal_vr","text":"","code":"bal_vr(nhefs_weights$age, nhefs_weights$qsmk) #> [1] 1.073075 # With weights bal_vr(nhefs_weights$wt71, nhefs_weights$qsmk,                       weights = nhefs_weights$w_ate) #> [1] 1.000901"},{"path":"https://r-causal.github.io/halfmoon/reference/check_balance.html","id":null,"dir":"Reference","previous_headings":"","what":"Check Balance Across Multiple Metrics — check_balance","title":"Check Balance Across Multiple Metrics — check_balance","text":"Computes balance statistics multiple variables across different groups optional weighting schemes. function generalizes balance checking supporting multiple metrics (SMD, variance ratio, Kolmogorov-Smirnov, weighted correlation) returns results tidy format.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/check_balance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check Balance Across Multiple Metrics — check_balance","text":"","code":"check_balance(   .data,   .vars,   .group,   .wts = NULL,   .metrics = c(\"smd\", \"vr\", \"ks\", \"energy\"),   include_observed = TRUE,   reference_group = 1L,   na.rm = FALSE,   make_dummy_vars = TRUE,   squares = FALSE,   cubes = FALSE,   interactions = FALSE )"},{"path":"https://r-causal.github.io/halfmoon/reference/check_balance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check Balance Across Multiple Metrics — check_balance","text":".data data frame containing variables analyze. .vars Variables calculate balance metrics. Can unquoted variable names, character vector, tidyselect expression. .group Grouping variable, e.g., treatment exposure group. .wts Optional weighting variables. Can unquoted variable names, character vector, NULL. Multiple weights can provided compare different weighting schemes. .metrics Character vector specifying metrics compute. Available options: \"smd\" (standardized mean difference), \"vr\" (variance ratio), \"ks\" (Kolmogorov-Smirnov), \"correlation\" (continuous exposures), \"energy\" (multivariate energy distance). Defaults c(\"smd\", \"vr\", \"ks\", \"energy\"). include_observed Logical. using .wts, also calculate observed metrics? Defaults TRUE. reference_group reference group level use comparisons. Defaults 1 (first level). na.rm logical value indicating whether remove missing values computation. Defaults FALSE. make_dummy_vars Logical. Transform categorical variables dummy variables using model.matrix()? Defaults TRUE. TRUE, categorical variables expanded separate binary indicators level. squares Logical. Include squared terms continuous variables? Defaults FALSE. TRUE, adds squared versions numeric variables. cubes Logical. Include cubed terms continuous variables? Defaults FALSE. TRUE, adds cubed versions numeric variables. interactions Logical. Include pairwise interactions variables? Defaults FALSE. TRUE, creates interaction terms variable pairs, excluding interactions levels categorical variable squared/cubed terms.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/check_balance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check Balance Across Multiple Metrics — check_balance","text":"tibble columns: variable Character. variable name analyzed. group_level Character. non-reference group level. method Character. weighting method (\"observed\" weight variable name). metric Character. balance metric computed (\"smd\", \"vr\", \"ks\"). estimate Numeric. computed balance statistic.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/check_balance.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check Balance Across Multiple Metrics — check_balance","text":"","code":"# Basic usage with all metrics check_balance(nhefs_weights, c(age, wt71), qsmk, .wts = c(w_ate, w_att)) #> # A tibble: 21 × 5 #>    variable group_level method   metric estimate #>    <chr>    <chr>       <chr>    <chr>     <dbl> #>  1 age      0           observed ks      0.130   #>  2 age      0           w_ate    ks      0.0293  #>  3 age      0           w_att    ks      0.0362  #>  4 age      0           observed smd     0.282   #>  5 age      0           w_ate    smd     0.00585 #>  6 age      0           w_att    smd     0.0122  #>  7 age      0           observed vr      1.07    #>  8 age      0           w_ate    vr      1.01    #>  9 age      0           w_att    vr      1.01    #> 10 wt71     0           observed ks      0.0700  #> # ℹ 11 more rows  # With specific metrics only check_balance(nhefs_weights, c(age, wt71), qsmk, .metrics = c(\"smd\", \"energy\")) #> # A tibble: 3 × 5 #>   variable group_level method   metric estimate #>   <chr>    <chr>       <chr>    <chr>     <dbl> #> 1 age      0           observed smd      0.282  #> 2 wt71     0           observed smd      0.133  #> 3 NA       NA          observed energy   0.0503  # Exclude observed results check_balance(nhefs_weights, c(age, wt71), qsmk, .wts = w_ate, include_observed = FALSE) #> # A tibble: 7 × 5 #>   variable group_level method metric estimate #>   <chr>    <chr>       <chr>  <chr>     <dbl> #> 1 age      0           w_ate  ks      0.0293  #> 2 age      0           w_ate  smd     0.00585 #> 3 age      0           w_ate  vr      1.01    #> 4 wt71     0           w_ate  ks      0.0358  #> 5 wt71     0           w_ate  smd    -0.00903 #> 6 wt71     0           w_ate  vr      1.00    #> 7 NA       NA          w_ate  energy  0.00217  # Use correlation for continuous exposure check_balance(mtcars, c(mpg, hp), disp, .metrics = c(\"correlation\", \"energy\")) #> # A tibble: 3 × 5 #>   variable group_level method   metric      estimate #>   <chr>    <chr>       <chr>    <chr>          <dbl> #> 1 hp       disp        observed correlation    0.791 #> 2 mpg      disp        observed correlation   -0.848 #> 3 NA       NA          observed energy         0.882  # With dummy variables for categorical variables (default behavior) check_balance(nhefs_weights, c(age, sex, race), qsmk) #> # A tibble: 10 × 5 #>    variable group_level method   metric estimate #>    <chr>    <chr>       <chr>    <chr>     <dbl> #>  1 age      0           observed ks       0.130  #>  2 age      0           observed smd      0.282  #>  3 age      0           observed vr       1.07   #>  4 race     0           observed ks       0.0568 #>  5 race     0           observed smd     -0.177  #>  6 race     0           observed vr       0.652  #>  7 sex      0           observed ks       0.0799 #>  8 sex      0           observed smd     -0.160  #>  9 sex      0           observed vr       0.996  #> 10 NA       NA          observed energy   0.0641  # Without dummy variables for categorical variables check_balance(nhefs_weights, c(age, sex, race), qsmk, make_dummy_vars = FALSE) #> # A tibble: 10 × 5 #>    variable group_level method   metric estimate #>    <chr>    <chr>       <chr>    <chr>     <dbl> #>  1 age      0           observed ks       0.130  #>  2 age      0           observed smd      0.282  #>  3 age      0           observed vr       1.07   #>  4 race     0           observed ks      NA      #>  5 race     0           observed smd     NA      #>  6 race     0           observed vr      NA      #>  7 sex      0           observed ks      NA      #>  8 sex      0           observed smd     NA      #>  9 sex      0           observed vr      NA      #> 10 NA       NA          observed energy   0.0641"},{"path":"https://r-causal.github.io/halfmoon/reference/check_calibration.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute calibration data for binary outcomes — check_calibration","title":"Compute calibration data for binary outcomes — check_calibration","text":"check_calibration() summarizes predicted probabilities observed outcomes, computing mean prediction, observed rate, counts, confidence intervals. Calibration represents agreement predicted probabilities observed outcomes. Supports multiple methods calibration assessment.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/check_calibration.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute calibration data for binary outcomes — check_calibration","text":"","code":"check_calibration(   data,   .fitted,   .group,   treatment_level = NULL,   method = c(\"breaks\", \"logistic\", \"windowed\"),   bins = 10,   binning_method = c(\"equal_width\", \"quantile\"),   smooth = TRUE,   conf_level = 0.95,   window_size = 0.1,   step_size = window_size/2,   k = 10,   na.rm = FALSE )"},{"path":"https://r-causal.github.io/halfmoon/reference/check_calibration.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute calibration data for binary outcomes — check_calibration","text":"data data frame containing data. .fitted Column name predicted probabilities (numeric 0 1). Can unquoted (e.g., p) quoted (e.g., \"p\"). .group Column name treatment/group variable. Can unquoted (e.g., g) quoted (e.g., \"g\"). treatment_level Value indicating level .group represents treatment. NULL (default), uses last level factors max value numeric. method Character; calibration method. One : \"breaks\", \"logistic\", \"windowed\". bins Integer > 1; number bins \"breaks\" method. binning_method \"equal_width\" \"quantile\" bin creation (breaks method ). smooth Logical; \"logistic\" method, use GAM smoothing via mgcv package. conf_level Numeric (0,1); confidence level CIs (default = 0.95). window_size Numeric; size window \"windowed\" method. step_size Numeric; distance window centers \"windowed\" method. k Integer; basis dimension GAM smoothing method = \"logistic\" smooth = TRUE. Default 10. na.rm Logical; TRUE, drop NA values summarizing.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/check_calibration.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute calibration data for binary outcomes — check_calibration","text":"tibble columns: \"breaks\" method: .bin: integer bin index fitted_mean: mean predicted probability bin group_mean: observed treatment rate bin count: number observations bin lower: lower bound CI group_mean upper: upper bound CI group_mean \"logistic\" \"windowed\" methods: fitted_mean: predicted probability values group_mean: calibrated outcome rate lower: lower bound CI upper: upper bound CI","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/check_calibration.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute calibration data for binary outcomes — check_calibration","text":"","code":"# Using the included `nhefs_weights` dataset # `.fitted` contains propensity scores, and `qsmk` is the treatment variable check_calibration(nhefs_weights, .fitted, qsmk) #> Warning: Small sample sizes or extreme proportions detected in bins 9, 10 (n = 8, 3). Confidence intervals may be unreliable. Consider using fewer bins or a different calibration method. #> # A tibble: 10 × 6 #>     .bin fitted_mean group_mean count  lower upper #>    <int>       <dbl>      <dbl> <int>  <dbl> <dbl> #>  1     1      0.0971     0.0649   154 0.0333 0.119 #>  2     2      0.162      0.166    355 0.130  0.210 #>  3     3      0.230      0.254    445 0.215  0.298 #>  4     4      0.302      0.294    293 0.243  0.350 #>  5     5      0.372      0.368    155 0.293  0.449 #>  6     6      0.443      0.372     86 0.272  0.484 #>  7     7      0.516      0.511     45 0.360  0.661 #>  8     8      0.591      0.773     22 0.542  0.913 #>  9     9      0.648      0.375      8 0.102  0.741 #> 10    10      0.738      1          3 1      1      # Logistic method with smoothing check_calibration(nhefs_weights, .fitted, qsmk, method = \"logistic\") #> # A tibble: 100 × 4 #>    fitted_mean group_mean     lower     upper #>          <dbl>  <dbl[1d]> <dbl[1d]> <dbl[1d]> #>  1      0.0510     0.0651    0.0363     0.114 #>  2      0.0583     0.0694    0.0404     0.117 #>  3      0.0657     0.0740    0.0448     0.120 #>  4      0.0730     0.0789    0.0497     0.123 #>  5      0.0803     0.0840    0.0549     0.126 #>  6      0.0877     0.0894    0.0606     0.130 #>  7      0.0950     0.0952    0.0666     0.134 #>  8      0.102      0.101     0.0730     0.139 #>  9      0.110      0.108     0.0797     0.144 #> 10      0.117      0.114     0.0868     0.149 #> # ℹ 90 more rows  # Windowed method check_calibration(nhefs_weights, .fitted, qsmk, method = \"windowed\") #> Warning: Small sample sizes or extreme proportions detected in windows centered at 0.7, 0.75, 0.8 (n = 5, 3, 1). Confidence intervals may be unreliable. Consider using a larger window size or a different calibration method. #> # A tibble: 16 × 4 #>    fitted_mean group_mean  lower upper #>          <dbl>      <dbl>  <dbl> <dbl> #>  1        0.05     0.0506 0.0163 0.131 #>  2        0.1      0.106  0.0731 0.152 #>  3        0.15     0.156  0.124  0.193 #>  4        0.2      0.212  0.180  0.248 #>  5        0.25     0.258  0.223  0.296 #>  6        0.3      0.290  0.248  0.337 #>  7        0.35     0.327  0.274  0.386 #>  8        0.4      0.370  0.301  0.444 #>  9        0.45     0.420  0.331  0.514 #> 10        0.5      0.467  0.352  0.585 #> 11        0.55     0.562  0.413  0.702 #> 12        0.6      0.724  0.525  0.866 #> 13        0.65     0.625  0.359  0.837 #> 14        0.7      0.6    0.170  0.927 #> 15        0.75     1      1      1     #> 16        0.8      1      1      1"},{"path":"https://r-causal.github.io/halfmoon/reference/ess.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the Effective Sample Size (ESS) — ess","title":"Calculate the Effective Sample Size (ESS) — ess","text":"function computes effective sample size (ESS) given vector weights, using classical \\((\\sum w)^2 / \\sum(w^2)\\) formula (sometimes referred \"Kish's effective sample size\").","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/ess.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the Effective Sample Size (ESS) — ess","text":"","code":"ess(wts)"},{"path":"https://r-causal.github.io/halfmoon/reference/ess.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the Effective Sample Size (ESS) — ess","text":"wts numeric vector weights (e.g., survey inverse-probability weighting).","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/ess.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the Effective Sample Size (ESS) — ess","text":"single numeric value representing effective sample size.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/ess.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate the Effective Sample Size (ESS) — ess","text":"effective sample size (ESS) reflects many observations equally weighted. weights vary substantially, ESS can much smaller actual number observations. Formally: $$   \\mathrm{ESS} = \\frac{\\left(\\sum_i w_i\\right)^2}{\\sum_i w_i^2}. $$ Diagnostic Value: Indicator Weight Concentration: large discrepancy ESS actual sample size indicates observations carry disproportionately large weights, effectively reducing usable information dataset. Variance Inflation: small ESS signals weighted estimates sensitive handful observations, inflating variance standard errors. Practical Guidance: ESS much lower total sample size, advisable investigate weights extremely large small. Techniques like weight trimming stabilized weights might employed mitigate issue","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/ess.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the Effective Sample Size (ESS) — ess","text":"","code":"# Suppose we have five observations with equal weights wts1 <- rep(1.2, 5) # returns 5, because all weights are equal ess(wts1) #> [1] 5  # If weights vary more, smaller than 5 wts2 <- c(0.5, 2, 2, 0.1, 0.8) ess(wts2) #> [1] 3.276404"},{"path":"https://r-causal.github.io/halfmoon/reference/geom_calibration.html","id":null,"dir":"Reference","previous_headings":"","what":"Geom for calibration plot with confidence intervals — geom_calibration","title":"Geom for calibration plot with confidence intervals — geom_calibration","text":"geom_calibration() creates calibration plots assess agreement predicted probabilities observed binary outcomes. supports three methods: binning (\"breaks\"), logistic regression (\"logistic\"), windowed (\"windowed\"), computed check_calibration().","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/geom_calibration.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Geom for calibration plot with confidence intervals — geom_calibration","text":"","code":"geom_calibration(   mapping = NULL,   data = NULL,   method = \"breaks\",   bins = 10,   smooth = TRUE,   conf_level = 0.95,   window_size = 0.1,   step_size = window_size/2,   treatment_level = NULL,   k = 10,   show_ribbon = TRUE,   show_points = TRUE,   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   inherit.aes = TRUE,   ... )"},{"path":"https://r-causal.github.io/halfmoon/reference/geom_calibration.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Geom for calibration plot with confidence intervals — geom_calibration","text":"mapping Aesthetic mapping (must supply x y inherited). x propensity scores/predicted probabilities, y treatment variable. data Data frame tibble; NULL, uses ggplot default. method Character; calibration method - \"breaks\", \"logistic\", \"windowed\". bins Integer >1; number bins \"breaks\" method. smooth Logical; \"logistic\" method, use GAM smoothing available. conf_level Numeric (0,1); confidence level CIs (default = 0.95). window_size Numeric; size window \"windowed\" method. step_size Numeric; distance window centers \"windowed\" method. treatment_level Value indicating level y represents treatment. NULL (default), uses last level factors max value numeric. factors numeric-looking levels (e.g., \"0\", \"1\"), parameter works expected. factors non-numeric levels (e.g., \"Control\", \"Treatment\"), function attempt use higher level treatment may always correctly identify intended level. cases, consider converting factor numeric plotting. k Integer; basis dimension GAM smoothing method = \"logistic\" smooth = TRUE. Default 10. show_ribbon Logical; show confidence interval ribbon. show_points Logical; show points (\"breaks\" \"windowed\" methods). position Position adjustment. na.rm Logical; TRUE, drop NA values computation. show.legend Logical; include legend. inherit.aes Logical; inherit aesthetics ggplot. ... Additional parameters passed geoms.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/geom_calibration.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Geom for calibration plot with confidence intervals — geom_calibration","text":"ggplot2 layer list layers","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/geom_calibration.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Geom for calibration plot with confidence intervals — geom_calibration","text":"","code":"library(ggplot2)  # Basic calibration plot using nhefs_weights dataset # .fitted contains propensity scores, qsmk is the treatment variable ggplot(nhefs_weights, aes(x = .fitted, y = qsmk)) +   geom_calibration() +   geom_abline(intercept = 0, slope = 1, linetype = \"dashed\") +   labs(x = \"Propensity Score\", y = \"Observed Treatment Rate\") #> Warning: Small sample sizes or extreme proportions detected in bins 9, 10 (n = 8, 3). Confidence intervals may be unreliable. Consider using fewer bins or a different calibration method. #> Warning: Small sample sizes or extreme proportions detected in bins 9, 10 (n = 8, 3). Confidence intervals may be unreliable. Consider using fewer bins or a different calibration method. #> Warning: Small sample sizes or extreme proportions detected in bins 9, 10 (n = 8, 3). Confidence intervals may be unreliable. Consider using fewer bins or a different calibration method.   # Using different methods ggplot(nhefs_weights, aes(x = .fitted, y = qsmk)) +   geom_calibration(method = \"logistic\") +   geom_abline(intercept = 0, slope = 1, linetype = \"dashed\") +   labs(x = \"Propensity Score\", y = \"Observed Treatment Rate\")   # Specify treatment level explicitly ggplot(nhefs_weights, aes(x = .fitted, y = qsmk)) +   geom_calibration(treatment_level = \"1\") +   geom_abline(intercept = 0, slope = 1, linetype = \"dashed\") +   labs(x = \"Propensity Score\", y = \"Observed Treatment Rate\") #> Warning: Small sample sizes or extreme proportions detected in bins 9, 10 (n = 8, 3). Confidence intervals may be unreliable. Consider using fewer bins or a different calibration method. #> Warning: Small sample sizes or extreme proportions detected in bins 9, 10 (n = 8, 3). Confidence intervals may be unreliable. Consider using fewer bins or a different calibration method. #> Warning: Small sample sizes or extreme proportions detected in bins 9, 10 (n = 8, 3). Confidence intervals may be unreliable. Consider using fewer bins or a different calibration method.   # Windowed method with custom parameters ggplot(nhefs_weights, aes(x = .fitted, y = qsmk)) +   geom_calibration(method = \"windowed\", window_size = 0.2, step_size = 0.1) +   geom_abline(intercept = 0, slope = 1, linetype = \"dashed\") +   labs(x = \"Propensity Score\", y = \"Observed Treatment Rate\") #> Warning: Small sample sizes or extreme proportions detected in windows centered at 0.8 (n = 3). Confidence intervals may be unreliable. Consider using a larger window size or a different calibration method. #> Warning: Small sample sizes or extreme proportions detected in windows centered at 0.8 (n = 3). Confidence intervals may be unreliable. Consider using a larger window size or a different calibration method. #> Warning: Small sample sizes or extreme proportions detected in windows centered at 0.8 (n = 3). Confidence intervals may be unreliable. Consider using a larger window size or a different calibration method."},{"path":"https://r-causal.github.io/halfmoon/reference/geom_ecdf.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate weighted and unweighted empirical cumulative distributions — geom_ecdf","title":"Calculate weighted and unweighted empirical cumulative distributions — geom_ecdf","text":"empirical cumulative distribution function (ECDF) provides alternative visualization distribution. geom_ecdf() similar ggplot2::stat_ecdf() can also calculate weighted ECDFs.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/geom_ecdf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate weighted and unweighted empirical cumulative distributions — geom_ecdf","text":"","code":"geom_ecdf(   mapping = NULL,   data = NULL,   geom = \"step\",   position = \"identity\",   ...,   n = NULL,   pad = TRUE,   na.rm = FALSE,   show.legend = NA,   inherit.aes = TRUE )"},{"path":"https://r-causal.github.io/halfmoon/reference/geom_ecdf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate weighted and unweighted empirical cumulative distributions — geom_ecdf","text":"mapping Set aesthetic mappings created aes(). specified inherit.aes = TRUE (default), combined default mapping top level plot. must supply mapping plot mapping. data data displayed layer. three options: NULL, default, data inherited plot data specified call ggplot(). data.frame, object, override plot data. objects fortified produce data frame. See fortify() variables created. function called single argument, plot data. return value must data.frame, used layer data. function can created formula (e.g. ~ head(.x, 10)). geom geometric object use display data layer. using stat_*() function construct layer, geom argument can used override default coupling stats geoms. geom argument accepts following: Geom ggproto subclass, example GeomPoint. string naming geom. give geom string, strip function name geom_ prefix. example, use geom_point(), give geom \"point\". information ways specify geom, see layer geom documentation. position position adjustment use data layer. can used various ways, including prevent overplotting improving display. position argument accepts following: result calling position function, position_jitter(). method allows passing extra arguments position. string naming position adjustment. give position string, strip function name position_ prefix. example, use position_jitter(), give position \"jitter\". information ways specify position, see layer position documentation. ... arguments passed layer()'s params argument. arguments broadly fall one 4 categories . Notably, arguments position argument, aesthetics required can passed .... Unknown arguments part 4 categories ignored. Static aesthetics mapped scale, fixed value apply layer whole. example, colour = \"red\" linewidth = 3. geom's documentation Aesthetics section lists available options. 'required' aesthetics passed params. Please note passing unmapped aesthetics vectors technically possible, order required length guaranteed parallel input data. constructing layer using stat_*() function, ... argument can used pass parameters geom part layer. example stat_density(geom = \"area\", outline.type = \"\"). geom's documentation lists parameters can accept. Inversely, constructing layer using geom_*() function, ... argument can used pass parameters stat part layer. example geom_area(stat = \"density\", adjust = 0.5). stat's documentation lists parameters can accept. key_glyph argument layer() may also passed .... can one functions described key glyphs, change display layer legend. n NULL, interpolate. NULL, number points interpolate . pad TRUE, pad ecdf additional points (-Inf, 0) (Inf, 1) na.rm FALSE (default), removes missing values warning.  TRUE silently removes missing values. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. can also named logical vector finely select aesthetics display. inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. borders().","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/geom_ecdf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate weighted and unweighted empirical cumulative distributions — geom_ecdf","text":"geom","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/geom_ecdf.html","id":"aesthetics","dir":"Reference","previous_headings":"","what":"Aesthetics","title":"Calculate weighted and unweighted empirical cumulative distributions — geom_ecdf","text":"addition aesthetics ggplot2::stat_ecdf(), geom_ecdf() also accepts: weights","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/geom_ecdf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate weighted and unweighted empirical cumulative distributions — geom_ecdf","text":"","code":"library(ggplot2)  ggplot(   nhefs_weights,   aes(x = smokeyrs, color = qsmk) ) +   geom_ecdf(aes(weights = w_ato)) +   xlab(\"Smoking Years\") +   ylab(\"Proportion <= x\")"},{"path":"https://r-causal.github.io/halfmoon/reference/geom_mirror_histogram.html","id":null,"dir":"Reference","previous_headings":"","what":"Create mirrored histograms — geom_mirror_histogram","title":"Create mirrored histograms — geom_mirror_histogram","text":"Create mirrored histograms","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/geom_mirror_histogram.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create mirrored histograms — geom_mirror_histogram","text":"","code":"geom_mirror_histogram(   mapping = NULL,   data = NULL,   position = \"stack\",   ...,   binwidth = NULL,   bins = NULL,   na.rm = FALSE,   orientation = NA,   show.legend = NA,   inherit.aes = TRUE )"},{"path":"https://r-causal.github.io/halfmoon/reference/geom_mirror_histogram.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create mirrored histograms — geom_mirror_histogram","text":"mapping Set aesthetic mappings created aes(). specified inherit.aes = TRUE (default), combined default mapping top level plot. must supply mapping plot mapping. data data displayed layer. three options: NULL, default, data inherited plot data specified call ggplot(). data.frame, object, override plot data. objects fortified produce data frame. See fortify() variables created. function called single argument, plot data. return value must data.frame, used layer data. function can created formula (e.g. ~ head(.x, 10)). position position adjustment use data layer. can used various ways, including prevent overplotting improving display. position argument accepts following: result calling position function, position_jitter(). method allows passing extra arguments position. string naming position adjustment. give position string, strip function name position_ prefix. example, use position_jitter(), give position \"jitter\". information ways specify position, see layer position documentation. ... arguments passed layer()'s params argument. arguments broadly fall one 4 categories . Notably, arguments position argument, aesthetics required can passed .... Unknown arguments part 4 categories ignored. Static aesthetics mapped scale, fixed value apply layer whole. example, colour = \"red\" linewidth = 3. geom's documentation Aesthetics section lists available options. 'required' aesthetics passed params. Please note passing unmapped aesthetics vectors technically possible, order required length guaranteed parallel input data. constructing layer using stat_*() function, ... argument can used pass parameters geom part layer. example stat_density(geom = \"area\", outline.type = \"\"). geom's documentation lists parameters can accept. Inversely, constructing layer using geom_*() function, ... argument can used pass parameters stat part layer. example geom_area(stat = \"density\", adjust = 0.5). stat's documentation lists parameters can accept. key_glyph argument layer() may also passed .... can one functions described key glyphs, change display layer legend. binwidth width bins. Can specified numeric value function calculates width unscaled x. , \"unscaled x\" refers original x values data, application scale transformation. specifying function along grouping structure, function called per group. default use number bins bins, covering range data. always override value, exploring multiple widths find best illustrate stories data. bin width date variable number days time; bin width time variable number seconds. bins Number bins. Overridden binwidth. Defaults 30. na.rm FALSE, default, missing values removed warning. TRUE, missing values silently removed. orientation orientation layer. default (NA) automatically determines orientation aesthetic mapping. rare event fails can given explicitly setting orientation either \"x\" \"y\". See Orientation section detail. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. can also named logical vector finely select aesthetics display. inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. borders().","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/geom_mirror_histogram.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create mirrored histograms — geom_mirror_histogram","text":"geom","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/geom_mirror_histogram.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create mirrored histograms — geom_mirror_histogram","text":"","code":"library(ggplot2) ggplot(nhefs_weights, aes(.fitted)) +   geom_mirror_histogram(     aes(group = qsmk),     bins = 50   ) +   geom_mirror_histogram(     aes(fill = qsmk, weight = w_ate),     bins = 50,     alpha = 0.5   ) +   scale_y_continuous(labels = abs)"},{"path":"https://r-causal.github.io/halfmoon/reference/nhefs_weights.html","id":null,"dir":"Reference","previous_headings":"","what":"NHEFS with various propensity score weights — nhefs_weights","title":"NHEFS with various propensity score weights — nhefs_weights","text":"dataset containing various propensity score weights causaldata::nhefs_complete.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/nhefs_weights.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"NHEFS with various propensity score weights — nhefs_weights","text":"","code":"nhefs_weights"},{"path":"https://r-causal.github.io/halfmoon/reference/nhefs_weights.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"NHEFS with various propensity score weights — nhefs_weights","text":"data frame 1566 rows 14 variables: qsmk Quit smoking race Race age Age sex Sex education Education level smokeintensity Smoking intensity smokeyrs Number smoke-years exercise Exercise level active Daily activity level wt71 Participant weight 1971 (baseline) w_ate ATE weight w_att ATT weight w_atc ATC weight w_atm ATM weight w_ato ATO weight .fitted Propensity score","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/plot_calibration.html","id":null,"dir":"Reference","previous_headings":"","what":"Create calibration plot — plot_calibration","title":"Create calibration plot — plot_calibration","text":"Create calibration plot assess agreement predicted probabilities observed treatment rates. function wraps geom_calibration().","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/plot_calibration.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create calibration plot — plot_calibration","text":"","code":"plot_calibration(   .data,   .fitted,   .group,   treatment_level = NULL,   method = \"breaks\",   bins = 10,   smooth = TRUE,   conf_level = 0.95,   window_size = 0.1,   step_size = window_size/2,   k = 10,   include_rug = FALSE,   include_ribbon = TRUE,   include_points = TRUE,   na.rm = FALSE,   ... )"},{"path":"https://r-causal.github.io/halfmoon/reference/plot_calibration.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create calibration plot — plot_calibration","text":".data data frame containing variables. .fitted Column name predicted probabilities (propensity scores). Can unquoted (e.g., .fitted) quoted (e.g., \".fitted\"). .group Column name treatment/group variable. Can unquoted (e.g., qsmk) quoted (e.g., \"qsmk\"). treatment_level Value indicating level .group represents treatment. NULL (default), uses last level factors max value numeric. method Character; calibration method - \"breaks\", \"logistic\", \"windowed\". bins Integer >1; number bins \"breaks\" method. smooth Logical; \"logistic\" method, use GAM smoothing available. conf_level Numeric (0,1); confidence level CIs (default = 0.95). window_size Numeric; size window \"windowed\" method. step_size Numeric; distance window centers \"windowed\" method. k Integer; basis dimension GAM smoothing method = \"logistic\" smooth = TRUE. Default 10. include_rug Logical; add rug plot showing distribution predicted probabilities. include_ribbon Logical; show confidence interval ribbon. include_points Logical; show points (\"breaks\" \"windowed\" methods). na.rm Logical; TRUE, drop NA values computation. ... Additional parameters passed geom_calibration().","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/plot_calibration.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create calibration plot — plot_calibration","text":"ggplot2 object.","code":""},{"path":"https://r-causal.github.io/halfmoon/reference/plot_calibration.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create calibration plot — plot_calibration","text":"","code":"library(ggplot2)  # Basic calibration plot plot_calibration(nhefs_weights, .fitted, qsmk) #> Warning: Small sample sizes or extreme proportions detected in bins 9, 10 (n = 8, 3). Confidence intervals may be unreliable. Consider using fewer bins or a different calibration method. #> Warning: Small sample sizes or extreme proportions detected in bins 9, 10 (n = 8, 3). Confidence intervals may be unreliable. Consider using fewer bins or a different calibration method. #> Warning: Small sample sizes or extreme proportions detected in bins 9, 10 (n = 8, 3). Confidence intervals may be unreliable. Consider using fewer bins or a different calibration method.   # With rug plot plot_calibration(nhefs_weights, .fitted, qsmk, include_rug = TRUE) #> Warning: Small sample sizes or extreme proportions detected in bins 9, 10 (n = 8, 3). Confidence intervals may be unreliable. Consider using fewer bins or a different calibration method. #> Warning: Small sample sizes or extreme proportions detected in bins 9, 10 (n = 8, 3). Confidence intervals may be unreliable. Consider using fewer bins or a different calibration method. #> Warning: Small sample sizes or extreme proportions detected in bins 9, 10 (n = 8, 3). Confidence intervals may be unreliable. Consider using fewer bins or a different calibration method.   # Different methods plot_calibration(nhefs_weights, .fitted, qsmk, method = \"logistic\")  plot_calibration(nhefs_weights, .fitted, qsmk, method = \"windowed\") #> Warning: Small sample sizes or extreme proportions detected in windows centered at 0.7, 0.75, 0.8 (n = 5, 3, 1). Confidence intervals may be unreliable. Consider using a larger window size or a different calibration method. #> Warning: Small sample sizes or extreme proportions detected in windows centered at 0.7, 0.75, 0.8 (n = 5, 3, 1). Confidence intervals may be unreliable. Consider using a larger window size or a different calibration method. #> Warning: Small sample sizes or extreme proportions detected in windows centered at 0.7, 0.75, 0.8 (n = 5, 3, 1). Confidence intervals may be unreliable. Consider using a larger window size or a different calibration method.   # Specify treatment level explicitly plot_calibration(nhefs_weights, .fitted, qsmk, treatment_level = \"1\") #> Warning: Small sample sizes or extreme proportions detected in bins 9, 10 (n = 8, 3). Confidence intervals may be unreliable. Consider using fewer bins or a different calibration method. #> Warning: Small sample sizes or extreme proportions detected in bins 9, 10 (n = 8, 3). Confidence intervals may be unreliable. Consider using fewer bins or a different calibration method. #> Warning: Small sample sizes or extreme proportions detected in bins 9, 10 (n = 8, 3). Confidence intervals may be unreliable. Consider using fewer bins or a different calibration method."},{"path":"https://r-causal.github.io/halfmoon/reference/reexports.html","id":null,"dir":"Reference","previous_headings":"","what":"Objects exported from other packages — reexports","title":"Objects exported from other packages — reexports","text":"objects imported packages. Follow links see documentation. tidyselect contains, ends_with, everything, last_col, matches, num_range, one_of, peek_vars, starts_with tidysmd bind_matches, geom_love, love_plot, tidy_smd","code":""},{"path":"https://r-causal.github.io/halfmoon/news/index.html","id":"halfmoon-0109000","dir":"Changelog","previous_headings":"","what":"halfmoon 0.1.0.9000","title":"halfmoon 0.1.0.9000","text":"Added NEWS.md file track changes package.","code":""}]
