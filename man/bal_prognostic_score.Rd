% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bal_prognostic_score.R
\name{bal_prognostic_score}
\alias{bal_prognostic_score}
\title{Compute Prognostic Scores for Balance Assessment}
\usage{
bal_prognostic_score(
  .data,
  outcome = NULL,
  covariates = everything(),
  .exposure,
  formula = NULL,
  .reference_level = NULL,
  family = gaussian(),
  .weights = NULL,
  na.rm = FALSE,
  ...
)
}
\arguments{
\item{.data}{A data frame containing the variables for analysis}

\item{outcome}{The outcome variable. Can be specified as a bare name or
character string. Ignored if \code{formula} is provided.}

\item{covariates}{Variables to include in the outcome model. Defaults to
\code{everything()} which includes all variables except the outcome and treatment.
Supports tidyselect syntax. Ignored if \code{formula} is provided.}

\item{.exposure}{The treatment variable. Can be specified as a bare name or
character string.}

\item{formula}{Optional formula for the outcome model. If provided, \code{outcome}
and \code{covariates} arguments are ignored. The formula should not include the
treatment variable.}

\item{.reference_level}{The level of treatment that represents the control group.
If NULL (default), the first level is used as control.}

\item{family}{A family object for the GLM. Defaults to \code{gaussian()} for
continuous outcomes. Use \code{binomial()} for binary outcomes.}

\item{na.rm}{Logical. Should missing values be removed? Defaults to FALSE.}

\item{...}{Additional arguments passed to \code{glm()}.}

\item{weights}{Optional weights for the outcome model. Can be a numeric vector
or bare name of a variable in \code{.data}.}
}
\value{
A numeric vector of prognostic scores with the same length as the
number of rows in \code{.data} (after NA removal if \code{na.rm = TRUE}).
}
\description{
Calculates prognostic scores by fitting an outcome model on the control group
and generating predictions for all observations. Prognostic scores represent
the expected outcome under control conditions and are useful for assessing
whether balance on treatment predictors ensures balance on outcome-relevant
variables.
}
\details{
The prognostic score method, introduced by Stuart et al. (2013), provides a
way to assess balance that focuses on variables predictive of the outcome
rather than just the treatment assignment. The procedure:
\enumerate{
\item Fits an outcome model using only control group observations
\item Generates predictions (prognostic scores) for all observations
\item Returns these scores for balance assessment
}

This approach is particularly useful when:
\itemize{
\item The outcome model includes non-linearities or interactions
\item You want to ensure balance on outcome-relevant variables
\item Traditional propensity score balance checks may miss important imbalances
}

The returned prognostic scores can be used with existing balance functions
like \code{bal_smd()}, \code{bal_vr()}, or \code{check_balance()} to assess balance between
treatment groups.
}
\examples{
# Using tidyselect interface
prog_scores <- bal_prognostic_score(
  nhefs_weights,
  outcome = wt82_71,
  .exposure = qsmk,
  covariates = c(age, sex, race, wt71)
)

# Using formula interface
prog_scores_formula <- bal_prognostic_score(
  nhefs_weights,
  .exposure = qsmk,
  formula = wt82_71 ~ age + sex + race + wt71 + I(age^2)
)

# Add to data and check balance
nhefs_with_prog <- nhefs_weights
nhefs_with_prog$prog_score <- prog_scores
check_balance(nhefs_with_prog, prog_score, qsmk, .weights = w_ate)

# For binary outcome
prog_scores_binary <- bal_prognostic_score(
  nhefs_weights,
  outcome = death,
  .exposure = qsmk,
  family = binomial()
)

}
\references{
Stuart EA, Lee BK, Leacy FP. Prognostic score-based balance measures can be
a useful diagnostic for propensity score methods in comparative effectiveness
research. J Clin Epidemiol. 2013;66(8):S84-S90.
}
\concept{balance}
