% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/geom_qq2.R
\name{geom_qq2}
\alias{geom_qq2}
\title{Create 2-dimensional QQ geometries}
\usage{
geom_qq2(
  mapping = NULL,
  data = NULL,
  stat = "qq2",
  position = "identity",
  na.rm = TRUE,
  show.legend = NA,
  inherit.aes = TRUE,
  quantiles = seq(0.01, 0.99, 0.01),
  treatment_level = NULL,
  ...
)
}
\arguments{
\item{mapping}{Set of aesthetic mappings. Required aesthetics are \code{sample} (variable)
and \code{treatment} (group). The \code{treatment} aesthetic can be a factor, character, or numeric.
Optional aesthetics include \code{weight} for weighting.}

\item{data}{Data frame to use. If not specified, inherits from the plot.}

\item{stat}{Statistical transformation to use. Default is "qq2".}

\item{position}{Position adjustment. Default is "identity".}

\item{na.rm}{If \code{FALSE}, the default, missing values are removed with a warning.
If \code{TRUE}, missing values are silently removed.}

\item{show.legend}{Logical. Should this layer be included in the legends?
\code{NA}, the default, includes if any aesthetics are mapped.}

\item{inherit.aes}{If \code{FALSE}, overrides the default aesthetics, rather than
combining with them.}

\item{quantiles}{Numeric vector of quantiles to compute. Default is
\code{seq(0.01, 0.99, 0.01)} for 99 quantiles.}

\item{treatment_level}{The level of the outcome variable to consider as the
treatment/event. If \code{NULL} (default), uses the last level for factors or
the maximum value for numeric variables.}

\item{...}{Other arguments passed on to layer().}
}
\value{
A ggplot2 layer.
}
\description{
\code{geom_qq2()} is a geom for creating quantile-quantile plots with support for
weighted comparisons. QQ plots compare the quantiles of two distributions,
making them useful for assessing distributional balance in causal inference.
As opposed to \code{geom_qq()}, this geom does not compare a variable against a
theoretical distribution, but rather against two group's distributions, e.g.,
treatment vs. control.
}
\details{
Quantile-quantile (QQ) plots visualize how the distributions of a variable
differ between treatment groups by plotting corresponding quantiles against
each other. If the distributions are identical, points fall on the 45-degree
line (y = x). Deviations from this line indicate differences in the distributions.

QQ plots are closely related to empirical cumulative distribution function
(ECDF) plots (see \code{\link[=geom_ecdf]{geom_ecdf()}}). While ECDF plots show \eqn{F(x) = P(X \leq x)}
for each group, QQ plots show \eqn{F_1^{-1}(p)} vs \eqn{F_2^{-1}(p)}, essentially the inverse
relationship. Both approaches visualize the same information about distributional
differences, but QQ plots make it easier to spot deviations through a 45-degree
reference line.
}
\examples{
library(ggplot2)

# Basic QQ plot
ggplot(nhefs_weights, aes(sample = age, treatment = qsmk)) +
  geom_qq2()

# With weighting
ggplot(nhefs_weights, aes(sample = age, treatment = qsmk, weight = w_ate)) +
  geom_qq2()

# Compare multiple weights using long format
long_data <- tidyr::pivot_longer(
  nhefs_weights,
  cols = c(w_ate, w_att),
  names_to = "weight_type",
  values_to = "weight"
)

ggplot(long_data, aes(color = weight_type)) +
  geom_qq2(aes(sample = age, treatment = qsmk, weight = weight)) +
  geom_abline(intercept = 0, slope = 1, linetype = "dashed")

}
\seealso{
\itemize{
\item \code{\link[=geom_ecdf]{geom_ecdf()}} for an alternative visualization of distributional differences
\item \code{\link[=plot_qq]{plot_qq()}} for a complete plotting function with reference line and labels
\item \code{\link[=qq]{qq()}} for the underlying data computation
}

Other ggplot2 functions: 
\code{\link{geom_calibration}()},
\code{\link{geom_ecdf}()},
\code{\link{geom_mirror_histogram}()},
\code{\link{geom_roc}()}
}
\concept{ggplot2 functions}
