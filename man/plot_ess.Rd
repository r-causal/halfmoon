% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_ess.R
\name{plot_ess}
\alias{plot_ess}
\title{Plot Effective Sample Size}
\usage{
plot_ess(
  .data,
  .weights = NULL,
  .group = NULL,
  include_observed = TRUE,
  n_tiles = 4,
  tile_labels = NULL,
  fill_color = "#0172B1",
  alpha = 0.8,
  show_labels = TRUE,
  label_size = 3,
  percent_scale = TRUE,
  reference_line_color = "gray50",
  reference_line_type = "dashed"
)
}
\arguments{
\item{.data}{A data frame, either:
\itemize{
\item Output from \code{check_ess()} containing ESS calculations
\item Raw data to compute ESS from (requires \code{.weights} to be specified)
}}

\item{.group}{Optional grouping variable. When provided, ESS is calculated
separately for each group level. For continuous variables, groups are
created using quantiles.}

\item{include_observed}{Logical. If using \code{.wts}, also calculate observed
(unweighted) metrics? Defaults to TRUE.}

\item{n_tiles}{For continuous \code{.group} variables, the number of quantile
groups to create. Default is 4 (quartiles).}

\item{tile_labels}{Optional character vector of labels for the quantile groups
when \code{.group} is continuous. If NULL, uses "Q1", "Q2", etc.}

\item{fill_color}{Color for the bars when \code{.group} is not provided.
Default is "#0172B1".}

\item{alpha}{Transparency level for the bars. Default is 0.8.}

\item{show_labels}{Logical. Show ESS percentage values as text labels on bars?
Default is TRUE.}

\item{label_size}{Size of text labels. Default is 3.}

\item{percent_scale}{Logical. Display ESS as percentage of sample size (TRUE)
or on original scale (FALSE)? Default is TRUE.}

\item{reference_line_color}{Color for the 100\% reference line. Default is "gray50".}

\item{reference_line_type}{Line type for the reference line. Default is "dashed".}
}
\value{
A ggplot2 object.
}
\description{
Creates a bar plot visualization of effective sample sizes (ESS) for different
weighting schemes. ESS values are shown as percentages of the actual sample size,
with a reference line at 100\% indicating no loss of effective sample size.
}
\details{
This function visualizes the output of \code{check_ess()} or computes ESS directly
from the provided data. The plot shows how much "effective" sample size remains
after weighting, which is a key diagnostic for assessing weight variability.

When \code{.group} is not provided, the function displays overall ESS for each
weighting method. When \code{.group} is provided, ESS is shown separately for each
group level using dodged bars.

For continuous grouping variables, the function automatically creates quantile
groups (quartiles by default) to show how ESS varies across the distribution
of the continuous variable.

Lower ESS percentages indicate:
\itemize{
\item Greater weight variability
\item More extreme weights
\item Potentially unstable weighted estimates
\item Need for weight trimming or alternative methods
}
}
\examples{
# Overall ESS for different weighting schemes
plot_ess(nhefs_weights, .weights = c(w_ate, w_att, w_atm))

# ESS by treatment group (binary exposure)
plot_ess(nhefs_weights, .weights = c(w_ate, w_att), .group = qsmk)

# ESS by treatment group (categorical exposure)
plot_ess(nhefs_weights, .weights = w_cat_ate, .group = alcoholfreq_cat)

# ESS by age quartiles
plot_ess(nhefs_weights, .weights = w_ate, .group = age)

# Customize quantiles for continuous variable
plot_ess(nhefs_weights, .weights = w_ate, .group = age,
         n_tiles = 5, tile_labels = c("Youngest", "Young", "Middle", "Older", "Oldest"))

# Without percentage labels
plot_ess(nhefs_weights, .weights = c(w_ate, w_att), .group = qsmk,
         show_labels = FALSE)

# Custom styling
plot_ess(nhefs_weights, .weights = c(w_ate, w_att), .group = qsmk,
         alpha = 0.6, fill_color = "steelblue",
         reference_line_color = "red")

# Using pre-computed ESS data
ess_data <- check_ess(nhefs_weights, .weights = c(w_ate, w_att))
plot_ess(ess_data)

# Show ESS on original scale instead of percentage
plot_ess(nhefs_weights, .weights = c(w_ate, w_att), percent_scale = FALSE)

}
\seealso{
\code{\link[=check_ess]{check_ess()}} for computing ESS values, \code{\link[=ess]{ess()}} for the underlying calculation
}
