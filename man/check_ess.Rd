% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/check_ess.R
\name{check_ess}
\alias{check_ess}
\title{Check Effective Sample Size}
\usage{
check_ess(
  .data,
  .weights = NULL,
  .group = NULL,
  include_observed = TRUE,
  n_tiles = 4,
  tile_labels = NULL
)
}
\arguments{
\item{.data}{A data frame containing the variables to analyze.}

\item{.weights}{Optional weighting variables. Can be unquoted variable names,
a character vector, or NULL. Multiple weights can be provided to compare
different weighting schemes.}

\item{.group}{Optional grouping variable. When provided, ESS is calculated
separately for each group level. For continuous variables, groups are
created using quantiles.}

\item{include_observed}{Logical. If using \code{.weights}, also calculate observed
(unweighted) metrics? Defaults to TRUE.}

\item{n_tiles}{For continuous \code{.group} variables, the number of quantile
groups to create. Default is 4 (quartiles).}

\item{tile_labels}{Optional character vector of labels for the quantile groups
when \code{.group} is continuous. If NULL, uses "Q1", "Q2", etc.}
}
\value{
A tibble with columns:
\item{method}{Character. The weighting method ("observed" or weight variable name).}
\item{group}{Character. The group level (if \code{.group} is provided).}
\item{n}{Integer. The number of observations in the group.}
\item{ess}{Numeric. The effective sample size.}
\item{ess_pct}{Numeric. ESS as a percentage of the actual sample size.}
}
\description{
Computes the effective sample size (ESS) for one or more weighting schemes,
optionally stratified by treatment groups. ESS reflects how many observations
you would have if all were equally weighted.
}
\details{
The effective sample size (ESS) is calculated using the classical formula:
\eqn{ESS = (\sum w)^2 / \sum(w^2)}.

When weights vary substantially, the ESS can be much smaller than the actual
number of observations, indicating that a few observations carry
disproportionately large weights.

When \code{.group} is provided, ESS is calculated separately for each group level:
\itemize{
\item For binary/categorical exposures: ESS is computed within each treatment level
\item For continuous exposures: The variable is divided into quantiles (using
\code{dplyr::ntile()}) and ESS is computed within each quantile
}

The function returns results in a tidy format suitable for plotting or
further analysis.
}
\examples{
# Overall ESS for different weighting schemes
check_ess(nhefs_weights, .weights = c(w_ate, w_att, w_atm))

# ESS by treatment group (binary exposure)
check_ess(nhefs_weights, .weights = c(w_ate, w_att), .group = qsmk)

# ESS by treatment group (categorical exposure)
check_ess(nhefs_weights, .weights = w_cat_ate, .group = alcoholfreq_cat)

# ESS by quartiles of a continuous variable
check_ess(nhefs_weights, .weights = w_ate, .group = age, n_tiles = 4)

# Custom labels for continuous groups
check_ess(nhefs_weights, .weights = w_ate, .group = age,
          n_tiles = 3, tile_labels = c("Young", "Middle", "Older"))

# Without unweighted comparison
check_ess(nhefs_weights, .weights = w_ate, .group = qsmk,
          include_observed = FALSE)

}
\seealso{
\code{\link[=ess]{ess()}} for the underlying ESS calculation, \code{\link[=plot_ess]{plot_ess()}} for visualization

Other balance functions: 
\code{\link{bal_corr}()},
\code{\link{bal_ess}()},
\code{\link{bal_ks}()},
\code{\link{bal_model_auc}()},
\code{\link{bal_model_roc_curve}()},
\code{\link{bal_qq}()},
\code{\link{bal_smd}()},
\code{\link{bal_vr}()},
\code{\link{check_balance}()},
\code{\link{check_model_auc}()},
\code{\link{check_model_roc_curve}()},
\code{\link{check_qq}()},
\code{\link{plot_balance}()}
}
\concept{balance functions}
