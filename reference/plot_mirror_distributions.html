<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create mirror distribution plots — plot_mirror_distributions • halfmoon</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create mirror distribution plots — plot_mirror_distributions"><meta name="description" content="Create mirror distribution plots (histograms or density plots) to compare
the distribution of variables between treatment groups before and after
weighting. This function helps assess covariate balance by visualizing
the distributions side-by-side with one group mirrored below the axis."><meta property="og:description" content="Create mirror distribution plots (histograms or density plots) to compare
the distribution of variables between treatment groups before and after
weighting. This function helps assess covariate balance by visualizing
the distributions side-by-side with one group mirrored below the axis."><meta property="og:image" content="https://r-causal.github.io/halfmoon/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">halfmoon</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-causal/halfmoon/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create mirror distribution plots</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-causal/halfmoon/blob/main/R/plot_mirror_distributions.R" class="external-link"><code>R/plot_mirror_distributions.R</code></a></small>
      <div class="d-none name"><code>plot_mirror_distributions.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create mirror distribution plots (histograms or density plots) to compare
the distribution of variables between treatment groups before and after
weighting. This function helps assess covariate balance by visualizing
the distributions side-by-side with one group mirrored below the axis.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_mirror_distributions</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  <span class="va">.var</span>,</span>
<span>  <span class="va">.exposure</span>,</span>
<span>  .weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"histogram"</span>, <span class="st">"density"</span><span class="op">)</span>,</span>
<span>  mirror_axis <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>  bins <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  binwidth <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bw <span class="op">=</span> <span class="st">"nrd0"</span>,</span>
<span>  adjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  include_unweighted <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  .reference_level <span class="op">=</span> <span class="fl">1L</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--data">.data<a class="anchor" aria-label="anchor" href="#arg--data"></a></dt>
<dd><p>A data frame containing the variables.</p></dd>


<dt id="arg--var">.var<a class="anchor" aria-label="anchor" href="#arg--var"></a></dt>
<dd><p>The variable to plot. Supports tidyselect syntax. Can be unquoted.</p></dd>


<dt id="arg--exposure">.exposure<a class="anchor" aria-label="anchor" href="#arg--exposure"></a></dt>
<dd><p>Column name of treatment/group variable. Supports tidyselect syntax. Can be unquoted.
For binary variables, must have exactly 2 levels. For categorical variables (&gt;2 levels),
creates pairwise comparisons against a reference group.</p></dd>


<dt id="arg--weights">.weights<a class="anchor" aria-label="anchor" href="#arg--weights"></a></dt>
<dd><p>Optional weighting variable(s). Can be unquoted variable names, tidyselect syntax,
a character vector, or NULL. Multiple weights can be provided to compare
different weighting schemes. Default is NULL (unweighted).</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Character; type of plot - "histogram" or "density". Default is "histogram".</p></dd>


<dt id="arg-mirror-axis">mirror_axis<a class="anchor" aria-label="anchor" href="#arg-mirror-axis"></a></dt>
<dd><p>Character; which axis to mirror - "y" (default) or "x".</p></dd>


<dt id="arg-bins">bins<a class="anchor" aria-label="anchor" href="#arg-bins"></a></dt>
<dd><p>Integer; number of bins for histogram. Only used when type = "histogram".</p></dd>


<dt id="arg-binwidth">binwidth<a class="anchor" aria-label="anchor" href="#arg-binwidth"></a></dt>
<dd><p>Numeric; width of bins for histogram. Only used when type = "histogram".
If both bins and binwidth are specified, binwidth takes precedence.</p></dd>


<dt id="arg-bw">bw<a class="anchor" aria-label="anchor" href="#arg-bw"></a></dt>
<dd><p>Bandwidth for density estimation. Only used when type = "density".
Can be numeric or character (e.g., "nrd0", "sj").</p></dd>


<dt id="arg-adjust">adjust<a class="anchor" aria-label="anchor" href="#arg-adjust"></a></dt>
<dd><p>Numeric; bandwidth adjustment factor for density. Only used when
type = "density". Default is 1.</p></dd>


<dt id="arg-include-unweighted">include_unweighted<a class="anchor" aria-label="anchor" href="#arg-include-unweighted"></a></dt>
<dd><p>Logical. If using <code>.weights</code>, also show unweighted
distribution? Defaults to TRUE.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Numeric; transparency level for fills. Default is 0.6.</p></dd>


<dt id="arg-na-rm">na.rm<a class="anchor" aria-label="anchor" href="#arg-na-rm"></a></dt>
<dd><p>Logical; if TRUE, drop NA values before plotting.</p></dd>


<dt id="arg--reference-level">.reference_level<a class="anchor" aria-label="anchor" href="#arg--reference-level"></a></dt>
<dd><p>The reference group level for categorical exposures (&gt;2 levels).
Can be a string (group level) or numeric (position). Defaults to 1 (first level).
Only used when .exposure has more than 2 levels.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ggplot2 object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Mirror distribution plots display the distribution of one group above the
x-axis and the other group below (mirrored). This makes it easy to compare
distributions and assess balance. The function supports both histogram and
density plot types.</p>
<p>For categorical exposures (&gt;2 levels), the function creates a grid of
pairwise comparisons against a reference group. Each panel shows one
non-reference level compared to the reference level using the mirror
distribution format.</p>
<p>When using weights, the function can display both weighted and unweighted
distributions for comparison. Multiple weighting schemes can be compared
by providing multiple weight variables.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="geom_mirror_histogram.html">geom_mirror_histogram()</a></code> for the underlying histogram geom</p></li>
<li><p><code><a href="geom_mirror_density.html">geom_mirror_density()</a></code> for the underlying density geom</p></li>
<li><p><code><a href="plot_qq.html">plot_qq()</a></code> for QQ plots, another distributional comparison</p></li>
<li><p><code><a href="geom_ecdf.html">geom_ecdf()</a></code> for ECDF plots</p></li>
</ul></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Basic histogram (unweighted)</span></span></span>
<span class="r-in"><span><span class="fu">plot_mirror_distributions</span><span class="op">(</span><span class="va">nhefs_weights</span>, <span class="va">age</span>, <span class="va">qsmk</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_mirror_distributions-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Density plot instead of histogram</span></span></span>
<span class="r-in"><span><span class="fu">plot_mirror_distributions</span><span class="op">(</span><span class="va">nhefs_weights</span>, <span class="va">age</span>, <span class="va">qsmk</span>, type <span class="op">=</span> <span class="st">"density"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_mirror_distributions-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With weighting</span></span></span>
<span class="r-in"><span><span class="fu">plot_mirror_distributions</span><span class="op">(</span><span class="va">nhefs_weights</span>, <span class="va">age</span>, <span class="va">qsmk</span>, .weights <span class="op">=</span> <span class="va">w_ate</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_mirror_distributions-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare multiple weighting schemes</span></span></span>
<span class="r-in"><span><span class="fu">plot_mirror_distributions</span><span class="op">(</span><span class="va">nhefs_weights</span>, <span class="va">age</span>, <span class="va">qsmk</span>, .weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">w_ate</span>, <span class="va">w_att</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_mirror_distributions-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Customize appearance</span></span></span>
<span class="r-in"><span><span class="fu">plot_mirror_distributions</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">nhefs_weights</span>, <span class="va">age</span>, <span class="va">qsmk</span>,</span></span>
<span class="r-in"><span>  .weights <span class="op">=</span> <span class="va">w_ate</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"density"</span>,</span></span>
<span class="r-in"><span>  alpha <span class="op">=</span> <span class="fl">0.7</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_mirror_distributions-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Without unweighted comparison</span></span></span>
<span class="r-in"><span><span class="fu">plot_mirror_distributions</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">nhefs_weights</span>, <span class="va">age</span>, <span class="va">qsmk</span>,</span></span>
<span class="r-in"><span>  .weights <span class="op">=</span> <span class="va">w_ate</span>,</span></span>
<span class="r-in"><span>  include_unweighted <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_mirror_distributions-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Categorical exposure - creates grid of comparisons</span></span></span>
<span class="r-in"><span><span class="fu">plot_mirror_distributions</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">nhefs_weights</span>,</span></span>
<span class="r-in"><span>  <span class="va">age</span>,</span></span>
<span class="r-in"><span>  <span class="va">alcoholfreq_cat</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"density"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_mirror_distributions-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Categorical with weights</span></span></span>
<span class="r-in"><span><span class="fu">plot_mirror_distributions</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">nhefs_weights</span>,</span></span>
<span class="r-in"><span>  <span class="va">wt71</span>,</span></span>
<span class="r-in"><span>  <span class="va">alcoholfreq_cat</span>,</span></span>
<span class="r-in"><span>  .weights <span class="op">=</span> <span class="va">w_cat_ate</span>,</span></span>
<span class="r-in"><span>  .reference_level <span class="op">=</span> <span class="st">"none"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_mirror_distributions-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Malcolm Barrett.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

