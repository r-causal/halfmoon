<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate Single ROC Curve for Model Balance Assessment — bal_model_roc_curve • halfmoon</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Single ROC Curve for Model Balance Assessment — bal_model_roc_curve"><meta name="description" content="Computes the Receiver Operating Characteristic (ROC) curve for a single
weighting scheme or unweighted data. In causal inference, an ROC curve
near the diagonal indicates good balance between treatment groups."><meta property="og:description" content="Computes the Receiver Operating Characteristic (ROC) curve for a single
weighting scheme or unweighted data. In causal inference, an ROC curve
near the diagonal indicates good balance between treatment groups."><meta property="og:image" content="https://r-causal.github.io/halfmoon/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">halfmoon</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-causal/halfmoon/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate Single ROC Curve for Model Balance Assessment</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-causal/halfmoon/blob/main/R/bal_model_roc_curve.R" class="external-link"><code>R/bal_model_roc_curve.R</code></a></small>
      <div class="d-none name"><code>bal_model_roc_curve.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes the Receiver Operating Characteristic (ROC) curve for a single
weighting scheme or unweighted data. In causal inference, an ROC curve
near the diagonal indicates good balance between treatment groups.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bal_model_roc_curve</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  <span class="va">.truth</span>,</span>
<span>  <span class="va">.estimate</span>,</span>
<span>  .wts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  treatment_level <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--data">.data<a class="anchor" aria-label="anchor" href="#arg--data"></a></dt>
<dd><p>A data frame containing the variables.</p></dd>


<dt id="arg--truth">.truth<a class="anchor" aria-label="anchor" href="#arg--truth"></a></dt>
<dd><p>The treatment/outcome variable (unquoted).</p></dd>


<dt id="arg--estimate">.estimate<a class="anchor" aria-label="anchor" href="#arg--estimate"></a></dt>
<dd><p>The propensity score or fitted values (unquoted).</p></dd>


<dt id="arg--wts">.wts<a class="anchor" aria-label="anchor" href="#arg--wts"></a></dt>
<dd><p>Optional single weight variable (unquoted). If NULL, computes
unweighted ROC curve.</p></dd>


<dt id="arg-na-rm">na.rm<a class="anchor" aria-label="anchor" href="#arg-na-rm"></a></dt>
<dd><p>A logical value indicating whether to remove missing values
before computation. If <code>FALSE</code> (default), missing values in the input
will produce <code>NA</code> in the output.</p></dd>


<dt id="arg-treatment-level">treatment_level<a class="anchor" aria-label="anchor" href="#arg-treatment-level"></a></dt>
<dd><p>The level of the outcome variable to consider as the
treatment/event. If <code>NULL</code> (default), uses the last level for factors or
the maximum value for numeric variables.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble with columns:</p>
<dl><dt>threshold</dt>
<dd><p>Numeric. The decision threshold.</p></dd>

<dt>sensitivity</dt>
<dd><p>Numeric. True positive rate at the threshold.</p></dd>

<dt>specificity</dt>
<dd><p>Numeric. True negative rate at the threshold.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The ROC curve plots sensitivity (true positive rate) against 1-specificity
(false positive rate) across all possible threshold values. When propensity
scores achieve perfect balance, the ROC curve should lie close to the diagonal
line from (0,0) to (1,1), indicating that the propensity scores have no
discriminatory ability between treatment groups.</p>
<p>ROC curves that bow significantly above the diagonal indicate that the
propensity scores can still distinguish between treatment groups, suggesting
inadequate balance.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="check_model_roc_curve.html">check_model_roc_curve()</a></code> for computing ROC curves across multiple weights,
<code><a href="bal_model_auc.html">bal_model_auc()</a></code> for the area under the curve summary</p>
<p>Other balance functions:
<code><a href="bal_corr.html">bal_corr</a>()</code>,
<code><a href="bal_ess.html">bal_ess</a>()</code>,
<code><a href="bal_ks.html">bal_ks</a>()</code>,
<code><a href="bal_model_auc.html">bal_model_auc</a>()</code>,
<code><a href="bal_qq.html">bal_qq</a>()</code>,
<code><a href="bal_smd.html">bal_smd</a>()</code>,
<code><a href="bal_vr.html">bal_vr</a>()</code>,
<code><a href="check_balance.html">check_balance</a>()</code>,
<code><a href="check_ess.html">check_ess</a>()</code>,
<code><a href="check_model_auc.html">check_model_auc</a>()</code>,
<code><a href="check_model_roc_curve.html">check_model_roc_curve</a>()</code>,
<code><a href="check_qq.html">check_qq</a>()</code>,
<code><a href="plot_balance.html">plot_balance</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Unweighted ROC curve</span></span></span>
<span class="r-in"><span><span class="fu">bal_model_roc_curve</span><span class="op">(</span><span class="va">nhefs_weights</span>, <span class="va">qsmk</span>, <span class="va">.fitted</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1,568 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    threshold sensitivity specificity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> -<span style="color: #BB0000;">Inf</span>            1        0       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>    0.051<span style="text-decoration: underline;">0</span>       1        0       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>    0.052<span style="text-decoration: underline;">7</span>       1        0.000<span style="text-decoration: underline;">860</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>    0.055<span style="text-decoration: underline;">8</span>       1        0.001<span style="text-decoration: underline;">72</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>    0.055<span style="text-decoration: underline;">9</span>       1        0.002<span style="text-decoration: underline;">58</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>    0.056<span style="text-decoration: underline;">7</span>       1        0.003<span style="text-decoration: underline;">44</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>    0.059<span style="text-decoration: underline;">5</span>       1        0.004<span style="text-decoration: underline;">30</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>    0.059<span style="text-decoration: underline;">9</span>       1        0.005<span style="text-decoration: underline;">16</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>    0.060<span style="text-decoration: underline;">1</span>       0.998    0.005<span style="text-decoration: underline;">16</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>    0.060<span style="text-decoration: underline;">8</span>       0.995    0.005<span style="text-decoration: underline;">16</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1,558 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Weighted ROC curve</span></span></span>
<span class="r-in"><span><span class="fu">bal_model_roc_curve</span><span class="op">(</span><span class="va">nhefs_weights</span>, <span class="va">qsmk</span>, <span class="va">.fitted</span>, <span class="va">w_ate</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1,568 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    threshold sensitivity specificity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> -<span style="color: #BB0000;">Inf</span>            1        0       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>    0.051<span style="text-decoration: underline;">0</span>       1        0       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>    0.052<span style="text-decoration: underline;">7</span>       1        0.000<span style="text-decoration: underline;">673</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>    0.055<span style="text-decoration: underline;">8</span>       1        0.001<span style="text-decoration: underline;">35</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>    0.055<span style="text-decoration: underline;">9</span>       1        0.002<span style="text-decoration: underline;">02</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>    0.056<span style="text-decoration: underline;">7</span>       1        0.002<span style="text-decoration: underline;">70</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>    0.059<span style="text-decoration: underline;">5</span>       1        0.003<span style="text-decoration: underline;">38</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>    0.059<span style="text-decoration: underline;">9</span>       1        0.004<span style="text-decoration: underline;">06</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>    0.060<span style="text-decoration: underline;">1</span>       0.989    0.004<span style="text-decoration: underline;">06</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>    0.060<span style="text-decoration: underline;">8</span>       0.979    0.004<span style="text-decoration: underline;">06</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1,558 more rows</span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Malcolm Barrett.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

