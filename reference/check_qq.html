<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Check QQ Data for Multiple Weights — check_qq • halfmoon</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Check QQ Data for Multiple Weights — check_qq"><meta name="description" content="Calculate quantile-quantile data comparing the distribution of a variable
between treatment groups. This function computes the quantiles for both
groups and returns a tidy data frame suitable for plotting or further analysis."><meta property="og:description" content="Calculate quantile-quantile data comparing the distribution of a variable
between treatment groups. This function computes the quantiles for both
groups and returns a tidy data frame suitable for plotting or further analysis."><meta property="og:image" content="https://r-causal.github.io/halfmoon/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">halfmoon</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-causal/halfmoon/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Check QQ Data for Multiple Weights</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-causal/halfmoon/blob/main/R/check_qq.R" class="external-link"><code>R/check_qq.R</code></a></small>
      <div class="d-none name"><code>check_qq.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate quantile-quantile data comparing the distribution of a variable
between treatment groups. This function computes the quantiles for both
groups and returns a tidy data frame suitable for plotting or further analysis.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">check_qq</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  <span class="va">.var</span>,</span>
<span>  <span class="va">.exposure</span>,</span>
<span>  .weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quantiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="fl">0.01</span><span class="op">)</span>,</span>
<span>  include_observed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  .reference_level <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--data">.data<a class="anchor" aria-label="anchor" href="#arg--data"></a></dt>
<dd><p>A data frame containing the variables.</p></dd>


<dt id="arg--var">.var<a class="anchor" aria-label="anchor" href="#arg--var"></a></dt>
<dd><p>Variable to compute quantiles for. Supports tidyselect syntax.</p></dd>


<dt id="arg--exposure">.exposure<a class="anchor" aria-label="anchor" href="#arg--exposure"></a></dt>
<dd><p>Column name of treatment/group variable. Supports tidyselect syntax.</p></dd>


<dt id="arg--weights">.weights<a class="anchor" aria-label="anchor" href="#arg--weights"></a></dt>
<dd><p>Optional weighting variable(s). Can be unquoted variable names (supports tidyselect syntax),
a character vector, or NULL. Multiple weights can be provided to compare
different weighting schemes. Default is NULL (unweighted).</p></dd>


<dt id="arg-quantiles">quantiles<a class="anchor" aria-label="anchor" href="#arg-quantiles"></a></dt>
<dd><p>Numeric vector of quantiles to compute. Default is
<code>seq(0.01, 0.99, 0.01)</code> for 99 quantiles.</p></dd>


<dt id="arg-include-observed">include_observed<a class="anchor" aria-label="anchor" href="#arg-include-observed"></a></dt>
<dd><p>Logical. If using <code>.weights</code>, also compute observed
(unweighted) quantiles? Defaults to TRUE.</p></dd>


<dt id="arg--reference-level">.reference_level<a class="anchor" aria-label="anchor" href="#arg--reference-level"></a></dt>
<dd><p>The reference treatment level to use for comparisons.
If <code>NULL</code> (default), uses the last level for factors or the maximum value for numeric variables.</p></dd>


<dt id="arg-na-rm">na.rm<a class="anchor" aria-label="anchor" href="#arg-na-rm"></a></dt>
<dd><p>Logical; if TRUE, drop NA values before computation.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble with class "halfmoon_qq" containing columns:</p>
<dl><dt>method</dt>
<dd><p>Character. The weighting method ("observed" or weight variable name).</p></dd>

<dt>quantile</dt>
<dd><p>Numeric. The quantile probability (0-1).</p></dd>

<dt>exposed_quantiles</dt>
<dd><p>Numeric. The quantile value for the exposed group.</p></dd>

<dt>unexposed_quantiles</dt>
<dd><p>Numeric. The quantile value for the unexposed group.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function computes the data needed for quantile-quantile plots by calculating
corresponding quantiles from two distributions. The computation uses the inverse
of the empirical cumulative distribution function (ECDF). For weighted data,
it first computes the weighted ECDF and then inverts it to obtain quantiles.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="bal_qq.html">bal_qq()</a></code> for single weight QQ data, <code><a href="plot_qq.html">plot_qq()</a></code> for visualization</p>
<p>Other balance functions:
<code><a href="bal_corr.html">bal_corr</a>()</code>,
<code><a href="bal_ess.html">bal_ess</a>()</code>,
<code><a href="bal_ks.html">bal_ks</a>()</code>,
<code><a href="bal_model_auc.html">bal_model_auc</a>()</code>,
<code><a href="bal_model_roc_curve.html">bal_model_roc_curve</a>()</code>,
<code><a href="bal_qq.html">bal_qq</a>()</code>,
<code><a href="bal_smd.html">bal_smd</a>()</code>,
<code><a href="bal_vr.html">bal_vr</a>()</code>,
<code><a href="check_balance.html">check_balance</a>()</code>,
<code><a href="check_ess.html">check_ess</a>()</code>,
<code><a href="check_model_auc.html">check_model_auc</a>()</code>,
<code><a href="check_model_roc_curve.html">check_model_roc_curve</a>()</code>,
<code><a href="plot_balance.html">plot_balance</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Basic QQ data (observed only)</span></span></span>
<span class="r-in"><span><span class="fu">check_qq</span><span class="op">(</span><span class="va">nhefs_weights</span>, <span class="va">age</span>, <span class="va">qsmk</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 99 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    method   quantile exposed_quantiles unexposed_quantiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> observed     0.01                25                25  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> observed     0.02                25                25  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> observed     0.03                26                25  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> observed     0.04                26                25.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> observed     0.05                27                26  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> observed     0.06                27                26  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> observed     0.07                28                26  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> observed     0.08                28                27  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> observed     0.09                29                27  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> observed     0.1                 29                28  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 89 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With weighting</span></span></span>
<span class="r-in"><span><span class="fu">check_qq</span><span class="op">(</span><span class="va">nhefs_weights</span>, <span class="va">age</span>, <span class="va">qsmk</span>, .weights <span class="op">=</span> <span class="va">w_ate</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 198 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    method   quantile exposed_quantiles unexposed_quantiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> observed     0.01                25                25  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> observed     0.02                25                25  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> observed     0.03                26                25  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> observed     0.04                26                25.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> observed     0.05                27                26  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> observed     0.06                27                26  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> observed     0.07                28                26  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> observed     0.08                28                27  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> observed     0.09                29                27  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> observed     0.1                 29                28  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 188 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare multiple weighting schemes</span></span></span>
<span class="r-in"><span><span class="fu">check_qq</span><span class="op">(</span><span class="va">nhefs_weights</span>, <span class="va">age</span>, <span class="va">qsmk</span>, .weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">w_ate</span>, <span class="va">w_att</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 297 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    method   quantile exposed_quantiles unexposed_quantiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> observed     0.01                25                25  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> observed     0.02                25                25  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> observed     0.03                26                25  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> observed     0.04                26                25.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> observed     0.05                27                26  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> observed     0.06                27                26  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> observed     0.07                28                26  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> observed     0.08                28                27  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> observed     0.09                29                27  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> observed     0.1                 29                28  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 287 more rows</span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Malcolm Barrett.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

